!function(e,t){for(var r in t)e[r]=t[r]}(exports,function(e){var t={};function r(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)r.d(n,i,function(t){return e[t]}.bind(null,i));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=0)}([function(e,t){function r(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function n(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const i={DC:{ltvLimits:.35,taxPeriods:2},"MD (excluding Montgomery County)":{ltvLimits:.2,taxPeriods:2},"Montgomery County, MD":{ltvLimits:.2,taxPeriods:2},VA:{ltvLimits:.2,taxPeriods:2}},o={Education:{btuPerSqft:23776/108e3,electricKwhPerSqft:10.964359201312984,pricePerSqft:100},"Grocery/Convenience Store":{btuPerSqft:42332/108e3,electricKwhPerSqft:48.6768782020259,pricePerSqft:150},"CafÃ©/Restaurants":{btuPerSqft:1.1555,electricKwhPerSqft:44.94022225597661,pricePerSqft:130},Healthcare:{btuPerSqft:63779/108e3,electricKwhPerSqft:25.738637184996985,pricePerSqft:160},"Outpatient Clinic":{btuPerSqft:25828/108e3,electricKwhPerSqft:18.754463438913834,pricePerSqft:160},"Inpatient Hospital":{btuPerSqft:92249/108e3,electricKwhPerSqft:30.978238466283457,pricePerSqft:160},Lodging:{btuPerSqft:37933/108e3,electricKwhPerSqft:15.288568204465287,pricePerSqft:250},Multifamily:{btuPerSqft:37933/108e3,electricKwhPerSqft:15.288568204465287,pricePerSqft:200},EnclosedAndStripMalls:{btuPerSqft:36842/108e3,electricKwhPerSqft:424e12/589e7/3413,pricePerSqft:200},"Retail (other than mall)":{btuPerSqft:13605/108e3,electricKwhPerSqft:15.137389043881027,pricePerSqft:200},Office:{btuPerSqft:17678/108e3,electricKwhPerSqft:15.887833438786915,pricePerSqft:250},"Religious worship":{btuPerSqft:19092/108e3,electricKwhPerSqft:5.207984727874119,pricePerSqft:100},"Warehouse and storage":{btuPerSqft:10629/108e3,electricKwhPerSqft:6.363175888869016,pricePerSqft:150},Vacant:{btuPerSqft:3993/108e3,electricKwhPerSqft:2.339659532744795,pricePerSqft:150}},a={"New England":{naturalGaseUse:111,naturalGasRegionRatio:.44,electricHeatConverted:172,electricRegionMultiplier:.37,conbimedUse:283,combinedElectricMultiplier:172/283,combinedNaturalGasMultiplier:111/283},"Middle Atlantic":{naturalGaseUse:389,naturalGasRegionRatio:1.56,electricHeatConverted:579,electricRegionMultiplier:1.23,conbimedUse:968,combinedElectricMultiplier:579/968,combinedNaturalGasMultiplier:389/968},"East North Central":{naturalGaseUse:494,naturalGasRegionRatio:1.98,electricHeatConverted:595,electricRegionMultiplier:1.26,conbimedUse:1089,combinedElectricMultiplier:595/1089,combinedNaturalGasMultiplier:494/1089},"West North Central":{naturalGaseUse:149,naturalGasRegionRatio:.6,electricHeatConverted:256,electricRegionMultiplier:.54,conbimedUse:405,combinedElectricMultiplier:256/405,combinedNaturalGasMultiplier:149/405},"South Atlantic":{naturalGaseUse:305,naturalGasRegionRatio:1.22,electricHeatConverted:978,electricRegionMultiplier:2.08,conbimedUse:1283,combinedElectricMultiplier:978/1283,combinedNaturalGasMultiplier:305/1283},"East South Central":{naturalGaseUse:104,naturalGasRegionRatio:.42,electricHeatConverted:241,electricRegionMultiplier:.51,conbimedUse:345,combinedElectricMultiplier:241/345,combinedNaturalGasMultiplier:104/345},"West South Central":{naturalGaseUse:207,naturalGasRegionRatio:.83,electricHeatConverted:590,electricRegionMultiplier:1.25,conbimedUse:797,combinedElectricMultiplier:590/797,combinedNaturalGasMultiplier:207/797},Mountain:{naturalGaseUse:163,naturalGasRegionRatio:.65,electricHeatConverted:229,electricRegionMultiplier:.49,conbimedUse:392,combinedElectricMultiplier:229/392,combinedNaturalGasMultiplier:163/392},Pacific:{naturalGaseUse:328,naturalGasRegionRatio:1.31,electricHeatConverted:600,electricRegionMultiplier:1.27,conbimedUse:928,combinedElectricMultiplier:600/928,combinedNaturalGasMultiplier:328/928}};function l(e){return void 0===e||""===e?error.value:isNaN(e)?error.value:parseFloat(e)}function c(){for(var e=arguments.length;e--;)if(arguments[e]instanceof Error)return!0;return!1}function u(e,t,r,n=0,i=0){if(c(e=l(e),t=l(t),r=l(r),n=l(n),i=l(i)))return error.value;var o;if(0===e)o=(r+n)/t;else{var a=Math.pow(1+e,t);o=1===i?(n*e/(a-1)+r*e/(1-1/a))/(1+e):n*e/(a-1)+r*e/(1-1/a)}return-o}const s=({region:e,monthlyEnergyCost:t})=>{const{combinedElectricMultiplier:r}=a[e];return 13.12150578*t*r},p=({region:e,monthlyEnergyCost:t})=>{const{combinedNaturalGasMultiplier:r}=a[e];return 13.12150578*t*r},f=({lightingUpgrade:e,monthlyEnergyCost:t,region:r,propertyType:n,sqft:i})=>{const{combinedNaturalGasMultiplier:l}=a[r],c=((({region:e,monthlyEnergyCost:t})=>{const{combinedElectricMultiplier:r}=a[e]})({monthlyEnergyCost:t,region:r}),s({monthlyEnergyCost:t,region:r})),u=e?0:.15*c*.5,p=(({propertyType:e,sqft:t})=>{const{electricKwhPerSqft:r}=o[e];return r*t*.11})({propertyType:n,sqft:i});return Math.max(c-p,u)},d=({region:e,propertyType:t,sqft:r,monthlyEnergyCost:n})=>{return p({region:e,monthlyEnergyCost:n})-(({propertyType:e,sqft:t})=>{const{btuPerSqft:r}=o[e];return r*t*.5})({propertyType:t,sqft:r})},g=({annualEnergySavings:e,propertyType:t,sqft:r,taxJurisdiction:n="DC",term:a=20})=>{const{ltvLimits:u,taxPeriods:s}=i[n],p=u*(o[t].pricePerSqft*r),f=e<0?0:function(e,t,r,n=0,i=0){return n=n||0,i=i||0,c(e=l(e),t=l(t),r=l(r),n=l(n),i=l(i))?error.value:0===e?-r*t-n:((1-Math.pow(1+e,t))/e*r*(1+e*i)-n)/Math.pow(1+e,t)}(.07/s,a*s,e/2),d=Math.abs(f/1.2);return Math.min(p,d)};t.handler=function(e,t,o){const{body:a}=e;let l={};try{l=JSON.parse(a)}catch(e){o(null,{statusCode:422,body:"No data provided"})}console.log("DATA",l);const c=(({propertyType:e,lightingUpgrade:t,region:r="Middle Atlantic",sqft:n,monthlyEnergyCost:i})=>{const o=s({monthlyEnergyCost:i,region:r}),a=p({monthlyEnergyCost:i,region:r}),l=f({lightingUpgrade:t,monthlyEnergyCost:i,region:r,propertyType:e,sqft:n}),c=d({region:r,propertyType:e,sqft:n,monthlyEnergyCost:i});return Math.min(.25*o,l)+Math.min(.25*a,c)})(l),y=g(function(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?r(i,!0).forEach(function(t){n(e,t,i[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):r(i).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))})}return e}({annualEnergySavings:c},l)),b=(({paceAmount:e,taxJurisdiction:t="DC",term:r=20})=>{const{taxPeriods:n}=i[t],o=Math.abs(u(.07/n,r*n,e));return Math.max(0,o/6)})({paceAmount:y}),m=(({annualEnergySavings:e,paceAmount:t,taxJurisdiction:r="DC",term:n=20})=>{const{taxPeriods:o}=i[r],a=Math.abs(u(.07/o,n*o,t));return Math.max(0,(e/2-a)*n)})({annualEnergySavings:c,paceAmount:y,pacePayments:b});o(null,{statusCode:200,headers:{"Content-Type":"application/json"},body:JSON.stringify({annualEnergySavings:Math.max(0,Math.round(c)),paceCanFinance:Math.round(y),pacePayments:Math.round(b),paceSavings:Math.round(m)})})}}]));